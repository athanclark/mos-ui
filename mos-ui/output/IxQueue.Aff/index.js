// Generated by purs version 0.11.7
"use strict";
var Control_Applicative = require("../Control.Applicative");
var Control_Bind = require("../Control.Bind");
var Control_Monad_Aff = require("../Control.Monad.Aff");
var Control_Monad_Eff = require("../Control.Monad.Eff");
var Control_Monad_Eff_Ref = require("../Control.Monad.Eff.Ref");
var Data_Either = require("../Data.Either");
var Data_Functor = require("../Data.Functor");
var Data_Maybe = require("../Data.Maybe");
var Data_Show = require("../Data.Show");
var Data_UUID = require("../Data.UUID");
var Data_Unit = require("../Data.Unit");
var IxQueue_Internal = require("../IxQueue.Internal");
var Prelude = require("../Prelude");
var IOQueues = function (x) {
    return x;
};
var registerSyncOnce = function (v) {
    return function (f) {
        return IxQueue_Internal.onceDefaultIxQueue(v.input)(function (ms) {
            return function (x) {
                if (ms instanceof Data_Maybe.Nothing) {
                    return Control_Applicative.pure(Control_Monad_Eff.applicativeEff)(Data_Unit.unit);
                };
                if (ms instanceof Data_Maybe.Just) {
                    return Control_Bind.bindFlipped(Control_Monad_Eff.bindEff)(IxQueue_Internal.putIxQueue(v.output)(ms.value0))(f(x));
                };
                throw new Error("Failed pattern match at IxQueue.Aff line 49, column 5 - line 51, column 44: " + [ ms.constructor.name ]);
            };
        });
    };
};
var registerSync = function (v) {
    return function (f) {
        return IxQueue_Internal.onDefaultIxQueue(v.input)(function (ms) {
            return function (x) {
                if (ms instanceof Data_Maybe.Nothing) {
                    return Control_Applicative.pure(Control_Monad_Eff.applicativeEff)(Data_Unit.unit);
                };
                if (ms instanceof Data_Maybe.Just) {
                    return Control_Bind.bindFlipped(Control_Monad_Eff.bindEff)(IxQueue_Internal.putIxQueue(v.output)(ms.value0))(f(x));
                };
                throw new Error("Failed pattern match at IxQueue.Aff line 60, column 5 - line 62, column 43: " + [ ms.constructor.name ]);
            };
        });
    };
};
var newIOQueues = function __do() {
    var v = IxQueue_Internal.newIxQueue();
    var v1 = IxQueue_Internal.newIxQueue();
    return {
        input: v,
        output: v1
    };
};
var callAsync = function (v) {
    return function (x) {
        return Control_Monad_Aff.makeAff(function (resolve) {
            return function __do() {
                var v1 = Data_Functor.map(Control_Monad_Eff.functorEff)(Data_Show.show(Data_UUID.showUUID))(Data_UUID.genUUID)();
                IxQueue_Internal.onceDefaultIxQueue(v.output)(function (v2) {
                    return function (y) {
                        return resolve(new Data_Either.Right(y));
                    };
                })();
                IxQueue_Internal.putIxQueue(v.input)(v1)(x)();
                return Control_Monad_Aff.nonCanceler;
            };
        });
    };
};
module.exports = {
    IOQueues: IOQueues,
    newIOQueues: newIOQueues,
    callAsync: callAsync,
    registerSyncOnce: registerSyncOnce,
    registerSync: registerSync
};
