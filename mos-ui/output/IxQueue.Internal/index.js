// Generated by purs version 0.11.7
"use strict";
var Control_Applicative = require("../Control.Applicative");
var Control_Bind = require("../Control.Bind");
var Control_Monad_Eff = require("../Control.Monad.Eff");
var Control_Monad_Eff_Ref = require("../Control.Monad.Eff.Ref");
var Data_Either = require("../Data.Either");
var Data_Foldable = require("../Data.Foldable");
var Data_Function = require("../Data.Function");
var Data_Functor = require("../Data.Functor");
var Data_Maybe = require("../Data.Maybe");
var Data_Semigroup = require("../Data.Semigroup");
var Data_StrMap = require("../Data.StrMap");
var Data_Traversable = require("../Data.Traversable");
var Data_Tuple = require("../Data.Tuple");
var Data_Unfoldable = require("../Data.Unfoldable");
var Data_Unit = require("../Data.Unit");
var Prelude = require("../Prelude");
var IxQueue = function (x) {
    return x;
};
var takeIxQueue = function (v) {
    return function (k) {
        return function __do() {
            var v1 = Control_Monad_Eff_Ref.readRef(v.individual)();
            var v2 = Data_StrMap.lookup(k)(v1);
            if (v2 instanceof Data_Maybe.Nothing) {
                return [  ];
            };
            if (v2 instanceof Data_Maybe.Just) {
                if (v2.value0 instanceof Data_Either.Left) {
                    Control_Monad_Eff_Ref.writeRef(v.individual)(Data_StrMap.insert(k)(new Data_Either.Left([  ]))(v1))();
                    return v2.value0.value0;
                };
                if (v2.value0 instanceof Data_Either.Right) {
                    return [  ];
                };
                throw new Error("Failed pattern match at IxQueue.Internal line 148, column 17 - line 152, column 25: " + [ v2.value0.constructor.name ]);
            };
            throw new Error("Failed pattern match at IxQueue.Internal line 146, column 3 - line 152, column 25: " + [ v2.constructor.name ]);
        };
    };
};
var takeDefaultIxQueue = function (v) {
    return function __do() {
        var v1 = Control_Monad_Eff_Ref.readRef(v["default"])();
        if (v1 instanceof Data_Either.Left) {
            Control_Monad_Eff_Ref.writeRef(v["default"])(new Data_Either.Left([  ]))();
            return v1.value0;
        };
        if (v1 instanceof Data_Either.Right) {
            return [  ];
        };
        throw new Error("Failed pattern match at IxQueue.Internal line 136, column 3 - line 140, column 23: " + [ v1.constructor.name ]);
    };
};
var readIxQueue = function (v) {
    return function (k) {
        return function __do() {
            var v1 = Control_Monad_Eff_Ref.readRef(v.individual)();
            var v2 = Data_StrMap.lookup(k)(v1);
            if (v2 instanceof Data_Maybe.Nothing) {
                return [  ];
            };
            if (v2 instanceof Data_Maybe.Just) {
                if (v2.value0 instanceof Data_Either.Left) {
                    return v2.value0.value0;
                };
                if (v2.value0 instanceof Data_Either.Right) {
                    return [  ];
                };
                throw new Error("Failed pattern match at IxQueue.Internal line 128, column 17 - line 130, column 25: " + [ v2.value0.constructor.name ]);
            };
            throw new Error("Failed pattern match at IxQueue.Internal line 126, column 3 - line 130, column 25: " + [ v2.constructor.name ]);
        };
    };
};
var readDefaultIxQueue = function (v) {
    return function __do() {
        var v1 = Control_Monad_Eff_Ref.readRef(v["default"])();
        if (v1 instanceof Data_Either.Left) {
            return v1.value0;
        };
        if (v1 instanceof Data_Either.Right) {
            return [  ];
        };
        throw new Error("Failed pattern match at IxQueue.Internal line 118, column 3 - line 120, column 23: " + [ v1.constructor.name ]);
    };
};
var putOnlyManyIxQueue = function (v) {
    return function (k) {
        return function (xs) {
            return function __do() {
                var v1 = Control_Monad_Eff_Ref.readRef(v.individual)();
                var v2 = Data_StrMap.lookup(k)(v1);
                if (v2 instanceof Data_Maybe.Nothing) {
                    return Control_Monad_Eff_Ref.writeRef(v.individual)(Data_StrMap.insert(k)(new Data_Either.Left(xs))(v1))();
                };
                if (v2 instanceof Data_Maybe.Just) {
                    if (v2.value0 instanceof Data_Either.Left) {
                        return Control_Monad_Eff_Ref.writeRef(v.individual)(Data_StrMap.insert(k)(new Data_Either.Left(Data_Semigroup.append(Data_Semigroup.semigroupArray)(v2.value0.value0)(xs)))(v1))();
                    };
                    if (v2.value0 instanceof Data_Either.Right) {
                        return Data_Foldable.traverse_(Control_Monad_Eff.applicativeEff)(Data_Foldable.foldableArray)(v2.value0.value0)(xs)();
                    };
                    throw new Error("Failed pattern match at IxQueue.Internal line 50, column 17 - line 52, column 32: " + [ v2.value0.constructor.name ]);
                };
                throw new Error("Failed pattern match at IxQueue.Internal line 48, column 3 - line 52, column 32: " + [ v2.constructor.name ]);
            };
        };
    };
};
var putOnlyIxQueue = function (q) {
    return function (k) {
        return function (x) {
            return putOnlyManyIxQueue(q)(k)([ x ]);
        };
    };
};
var putManyIxQueue = function (v) {
    return function (k) {
        return function (xs) {
            return function __do() {
                var v1 = Control_Monad_Eff_Ref.readRef(v.individual)();
                var v2 = Data_StrMap.lookup(k)(v1);
                if (v2 instanceof Data_Maybe.Nothing) {
                    var v3 = Control_Monad_Eff_Ref.readRef(v["default"])();
                    if (v3 instanceof Data_Either.Left) {
                        return Control_Monad_Eff_Ref.writeRef(v["default"])(new Data_Either.Left(Data_Semigroup.append(Data_Semigroup.semigroupArray)(v3.value0)(xs)))();
                    };
                    if (v3 instanceof Data_Either.Right) {
                        return Data_Foldable.traverse_(Control_Monad_Eff.applicativeEff)(Data_Foldable.foldableArray)(v3.value0(new Data_Maybe.Just(k)))(xs)();
                    };
                    throw new Error("Failed pattern match at IxQueue.Internal line 35, column 7 - line 37, column 45: " + [ v3.constructor.name ]);
                };
                if (v2 instanceof Data_Maybe.Just) {
                    if (v2.value0 instanceof Data_Either.Left) {
                        return Control_Monad_Eff_Ref.writeRef(v.individual)(Data_StrMap.insert(k)(new Data_Either.Left(Data_Semigroup.append(Data_Semigroup.semigroupArray)(v2.value0.value0)(xs)))(v1))();
                    };
                    if (v2.value0 instanceof Data_Either.Right) {
                        return Data_Foldable.traverse_(Control_Monad_Eff.applicativeEff)(Data_Foldable.foldableArray)(v2.value0.value0)(xs)();
                    };
                    throw new Error("Failed pattern match at IxQueue.Internal line 38, column 17 - line 40, column 32: " + [ v2.value0.constructor.name ]);
                };
                throw new Error("Failed pattern match at IxQueue.Internal line 32, column 3 - line 40, column 32: " + [ v2.constructor.name ]);
            };
        };
    };
};
var putIxQueue = function (q) {
    return function (k) {
        return function (x) {
            return putManyIxQueue(q)(k)([ x ]);
        };
    };
};
var onIxQueue = function (v) {
    return function (k) {
        return function (f) {
            return function __do() {
                var v1 = Control_Monad_Eff_Ref.readRef(v.individual)();
                (function () {
                    var v2 = Data_StrMap.lookup(k)(v1);
                    if (v2 instanceof Data_Maybe.Nothing) {
                        return Control_Applicative.pure(Control_Monad_Eff.applicativeEff)(Data_Unit.unit);
                    };
                    if (v2 instanceof Data_Maybe.Just) {
                        if (v2.value0 instanceof Data_Either.Left) {
                            return Data_Foldable.traverse_(Control_Monad_Eff.applicativeEff)(Data_Foldable.foldableArray)(f)(v2.value0.value0);
                        };
                        if (v2.value0 instanceof Data_Either.Right) {
                            return Control_Applicative.pure(Control_Monad_Eff.applicativeEff)(Data_Unit.unit);
                        };
                        throw new Error("Failed pattern match at IxQueue.Internal line 87, column 17 - line 89, column 27: " + [ v2.value0.constructor.name ]);
                    };
                    throw new Error("Failed pattern match at IxQueue.Internal line 85, column 3 - line 89, column 27: " + [ v2.constructor.name ]);
                })()();
                return Control_Monad_Eff_Ref.writeRef(v.individual)(Data_StrMap.insert(k)(new Data_Either.Right(f))(v1))();
            };
        };
    };
};
var onDefaultIxQueue = function (v) {
    return function (f) {
        return function __do() {
            var v1 = Control_Monad_Eff_Ref.readRef(v["default"])();
            (function () {
                if (v1 instanceof Data_Either.Left) {
                    return Data_Foldable.traverse_(Control_Monad_Eff.applicativeEff)(Data_Foldable.foldableArray)(f(Data_Maybe.Nothing.value))(v1.value0);
                };
                if (v1 instanceof Data_Either.Right) {
                    return Control_Applicative.pure(Control_Monad_Eff.applicativeEff)(Data_Unit.unit);
                };
                throw new Error("Failed pattern match at IxQueue.Internal line 76, column 3 - line 78, column 25: " + [ v1.constructor.name ]);
            })()();
            return Control_Monad_Eff_Ref.writeRef(v["default"])(new Data_Either.Right(f))();
        };
    };
};
var newIxQueue = function __do() {
    var v = Control_Monad_Eff_Ref.newRef(Data_StrMap.empty)();
    var v1 = Control_Monad_Eff_Ref.newRef(new Data_Either.Left([  ]))();
    return {
        individual: v,
        "default": v1
    };
};
var delIxQueue = function (v) {
    return function (k) {
        return function __do() {
            var v1 = Control_Monad_Eff_Ref.readRef(v.individual)();
            var v2 = Data_StrMap.lookup(k)(v1);
            if (v2 instanceof Data_Maybe.Nothing) {
                return false;
            };
            if (v2 instanceof Data_Maybe.Just) {
                if (v2.value0 instanceof Data_Either.Left) {
                    return false;
                };
                if (v2.value0 instanceof Data_Either.Right) {
                    Control_Monad_Eff_Ref.writeRef(v.individual)(Data_StrMap.insert(k)(new Data_Either.Left([  ]))(v1))();
                    return true;
                };
                throw new Error("Failed pattern match at IxQueue.Internal line 171, column 17 - line 175, column 14: " + [ v2.value0.constructor.name ]);
            };
            throw new Error("Failed pattern match at IxQueue.Internal line 169, column 3 - line 175, column 14: " + [ v2.constructor.name ]);
        };
    };
};
var onceIxQueue = function (q) {
    return function (k) {
        return function (f) {
            return function __do() {
                var v = Control_Monad_Eff_Ref.newRef(false)();
                return onIxQueue(q)(k)(function (x) {
                    return function __do() {
                        var v1 = Control_Monad_Eff_Ref.readRef(v)();
                        return Control_Applicative.unless(Control_Monad_Eff.applicativeEff)(v1)(function __do() {
                            f(x)();
                            Control_Monad_Eff_Ref.writeRef(v)(true)();
                            return Data_Functor.voidRight(Control_Monad_Eff.functorEff)(Data_Unit.unit)(delIxQueue(q)(k))();
                        })();
                    };
                })();
            };
        };
    };
};
var delDefaultIxQueue = function (v) {
    return function __do() {
        var v1 = Control_Monad_Eff_Ref.readRef(v["default"])();
        if (v1 instanceof Data_Either.Left) {
            return false;
        };
        if (v1 instanceof Data_Either.Right) {
            Control_Monad_Eff_Ref.writeRef(v["default"])(new Data_Either.Left([  ]))();
            return true;
        };
        throw new Error("Failed pattern match at IxQueue.Internal line 158, column 3 - line 162, column 16: " + [ v1.constructor.name ]);
    };
};
var onceDefaultIxQueue = function (q) {
    return function (f) {
        return function __do() {
            var v = Control_Monad_Eff_Ref.newRef(false)();
            return onDefaultIxQueue(q)(function (ms) {
                return function (x) {
                    return function __do() {
                        var v1 = Control_Monad_Eff_Ref.readRef(v)();
                        return Control_Applicative.unless(Control_Monad_Eff.applicativeEff)(v1)(function __do() {
                            f(ms)(x)();
                            Control_Monad_Eff_Ref.writeRef(v)(true)();
                            return Data_Functor.voidRight(Control_Monad_Eff.functorEff)(Data_Unit.unit)(delDefaultIxQueue(q))();
                        })();
                    };
                };
            })();
        };
    };
};
var broadcastManyIxQueue = function (v) {
    return function (xs) {
        return function __do() {
            (function __do() {
                var v1 = Control_Monad_Eff_Ref.readRef(v["default"])();
                if (v1 instanceof Data_Either.Left) {
                    return Control_Monad_Eff_Ref.writeRef(v["default"])(new Data_Either.Left(Data_Semigroup.append(Data_Semigroup.semigroupArray)(v1.value0)(xs)))();
                };
                if (v1 instanceof Data_Either.Right) {
                    return Data_Foldable.traverse_(Control_Monad_Eff.applicativeEff)(Data_Foldable.foldableArray)(v1.value0(Data_Maybe.Nothing.value))(xs)();
                };
                throw new Error("Failed pattern match at IxQueue.Internal line 62, column 9 - line 64, column 46: " + [ v1.constructor.name ]);
            })();
            var v1 = Control_Monad_Eff_Ref.readRef(v.individual)();
            return Data_Foldable.traverse_(Control_Monad_Eff.applicativeEff)(Data_Foldable.foldableArray)(function (x) {
                return Data_Foldable.traverse_(Control_Monad_Eff.applicativeEff)(Data_Foldable.foldableArray)(function (v2) {
                    if (v2.value1 instanceof Data_Either.Left) {
                        return Control_Monad_Eff_Ref.writeRef(v.individual)(Data_StrMap.insert(v2.value0)(new Data_Either.Left(Data_Semigroup.append(Data_Semigroup.semigroupArray)(v2.value1.value0)([ x ])))(v1));
                    };
                    if (v2.value1 instanceof Data_Either.Right) {
                        return v2.value1.value0(x);
                    };
                    throw new Error("Failed pattern match at IxQueue.Internal line 67, column 49 - line 69, column 48: " + [ v2.value1.constructor.name ]);
                })(Data_StrMap.toUnfoldable(Data_Unfoldable.unfoldableArray)(v1));
            })(xs)();
        };
    };
};
var broadcastIxQueue = function (q) {
    return function (x) {
        return broadcastManyIxQueue(q)([ x ]);
    };
};
module.exports = {
    IxQueue: IxQueue,
    newIxQueue: newIxQueue,
    putIxQueue: putIxQueue,
    putManyIxQueue: putManyIxQueue,
    putOnlyIxQueue: putOnlyIxQueue,
    putOnlyManyIxQueue: putOnlyManyIxQueue,
    broadcastIxQueue: broadcastIxQueue,
    broadcastManyIxQueue: broadcastManyIxQueue,
    onDefaultIxQueue: onDefaultIxQueue,
    onIxQueue: onIxQueue,
    onceDefaultIxQueue: onceDefaultIxQueue,
    onceIxQueue: onceIxQueue,
    readDefaultIxQueue: readDefaultIxQueue,
    readIxQueue: readIxQueue,
    takeDefaultIxQueue: takeDefaultIxQueue,
    takeIxQueue: takeIxQueue,
    delDefaultIxQueue: delDefaultIxQueue,
    delIxQueue: delIxQueue
};
